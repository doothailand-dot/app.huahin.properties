<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Huahin Properties | Premium Display</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;900&display=swap');
        body { font-family: 'Prompt', sans-serif; background-color: #8cabd9; }
        .property-bubble { background-color: #ffffff; border-radius: 35px; overflow: hidden; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.12); position: relative; }
        
        /* เทคนิค Background Hero: รูปโตและอยู่ด้านหลัง */
        .hero-img { 
            width: 100%; height: 350px; 
            background-size: cover; background-position: center; 
            position: relative; background-color: #eee;
        }

        /* ป้าย Code แปะหน้าสุด */
        .badge-code { 
            position: absolute; top: 15px; left: 15px; 
            background-color: #06C755; color: white; 
            padding: 4px 12px; border-radius: 20px; 
            font-size: 10px; font-weight: 700; z-index: 10;
        }

        .status-style { padding: 4px 10px; border-radius: 20px; font-size: 9px; font-weight: 800; text-transform: uppercase; white-space: nowrap; }
    </style>
</head>
<body class="pb-10">
    <header class="bg-white/90 backdrop-blur-md px-4 py-3 flex items-center justify-center sticky top-0 z-30 border-b">
        <div class="font-black text-blue-900 text-[10px] uppercase tracking-widest">HUAHIN PROPERTIES</div>
    </header>

    <main id="app" class="max-w-xl mx-auto px-4 py-6"></main>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbySAdfx_Exm6QHYJRcgSAYBWqWFk3l4ldj4pI6Uc2eAkhkpD_SvE0UDwBSfOPWgAxY1/exec"; 
        
        function fixLink(url) {
            if (!url) return 'https://via.placeholder.com/600x400?text=No+Image';
            if (url.includes('drive.google.com')) {
                const id = url.match(/[-\w]{25,}/);
                return id ? `https://drive.google.com/thumbnail?id=${id[0]}&sz=w1000` : url;
            }
            return url;
        }

        async function initLiff() {
            try {
                await liff.init({ liffId: "2008909867-tJ76yUtj" });
                const res = await fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ action: "getProperties" }) });
                const properties = await res.json();
                render(properties);
            } catch (err) { console.error(err); }
        }

        function render(properties) {
            const container = document.getElementById('app');
            container.innerHTML = properties.map(p => `
                <div class="property-bubble">
                    <div class="hero-img" style="background-image: url('${fixLink(p.Thumbnail)}');">
                        <div class="badge-code">Code: ${p.ID || '-'}</div>
                    </div>
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-4">
                            <div class="status-style bg-[#06C755] text-white">Plot : ${p.Plot || '-'}</div>
                            <div class="status-style bg-[#06C755] text-white">${p.Status || 'Active'}</div>
                        </div>
                        <div class="bg-gray-50 rounded-[25px] p-5 mb-5 border border-gray-100">
                            <p class="text-[14px] text-gray-500 mb-4 leading-relaxed">${p.Description || '-'}</p>
                            <div class="grid grid-cols-2 gap-2 border-t pt-4">
                                <div class="text-[11px] text-gray-400">Bed: ${p["Bed Room"] || '-'}</div>
                                <div class="text-[11px] text-gray-400">Bath: ${p["Bath Room"] || '-'}</div>
                                <div class="text-[11px] text-gray-400">Land: ${p["Land sq.m"] || '-'} m²</div>
                                <div class="text-[11px] font-bold text-[#06C755]">Price: ฿${Number(p.Price || 0).toLocaleString()}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        initLiff();
    </script>
</body>
</html>
