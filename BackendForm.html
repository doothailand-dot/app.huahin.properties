<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #f0f4f8; }
        .form-card { background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 10px; margin-top: 4px; outline: none; }
        input:focus { border-color: #06C755; }
        label { font-size: 13px; color: #64748b; font-weight: 600; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-bold text-gray-800">üè† ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</h1>
            <button onclick="resetForm()" class="bg-gray-200 px-4 py-2 rounded-xl text-sm font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà +</button>
        </div>

        <div class="form-card p-6 mb-8">
            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)</label>
            <select id="editSelector" onchange="loadSelectedData()" class="bg-blue-50 border-blue-200">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç / ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà --</option>
            </select>
        </div>

        <form id="propertyForm" onsubmit="handleFormSubmit(this)" class="form-card p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="md:col-span-2 border-b pb-2"><h2 class="text-blue-600 font-bold">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å</h2></div>
            <div><label>ID (‡πÄ‡∏ä‡πà‡∏ô M23)</label><input type="text" name="ID" id="ID" required></div>
            <div><label>Plot Number</label><input type="text" name="Plot" id="Plot"></div>
            <div><label>Type (‡πÄ‡∏ä‡πà‡∏ô House, Condo)</label><input type="text" name="Type" id="Type"></div>
            <div>
                <label>Status (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞)</label>
                <select name="Status" id="Status">
                    <option value="Ready to move in">Ready to move in (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)</option>
                    <option value="Under Const">Under Const (‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á)</option>
                    <option value="Sold Out">Sold Out (‡∏™‡∏µ‡πÅ‡∏î‡∏á)</option>
                    <option value="Empty space">Empty space (‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß)</option>
                </select>
            </div>
            <div><label>Badge (‡πÄ‡∏ä‡πà‡∏ô HOT DEAL)</label><input type="text" name="Badge" id="Badge"></div>
            <div class="md:col-span-2"><label>Description (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)</label><textarea name="Description" id="Description" rows="3"></textarea></div>

            <div class="md:col-span-2 border-b pb-2"><h2 class="text-blue-600 font-bold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Icons)</h2></div>
            <div><label>Bed Room (‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô)</label><input type="text" name="BedRoom" id="BedRoom"></div>
            <div><label>Bath Room (‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥)</label><input type="text" name="BathRoom" id="BathRoom"></div>
            <div><label>Pa Vilion (‡∏®‡∏≤‡∏•‡∏≤)</label><select name="PaVilion" id="PaVilion"><option value="Yes">Yes</option><option value="No">No</option></select></div>
            <div><label>Land sq.m (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏ï‡∏£.‡∏°.)</label><input type="text" name="LandSqM" id="LandSqM"></div>
            <div><label>Land sq.w (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏ï‡∏£.‡∏ß.)</label><input type="text" name="LandSqW" id="LandSqW"></div>
            <div><label>House Size (‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡πâ‡∏≤‡∏ô)</label><input type="text" name="HouseSize" id="HouseSize"></div>
            <div><label>Pool Size (‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏£‡∏∞)</label><input type="text" name="PoolSize" id="PoolSize"></div>
            <div><label>Pool Deep (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å)</label><input type="text" name="PoolDeep" id="PoolDeep"></div>
            <div><label>Car park (‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏î‡∏£‡∏ñ)</label><input type="text" name="CarPark" id="CarPark"></div>
            <div><label>Electrical (‡πÑ‡∏ü‡∏ü‡πâ‡∏≤)</label><select name="Electrical" id="Electrical"><option value="3-Phase">3-Phase</option><option value="Single Phase">Single Phase</option></select></div>
            <div><label>Furniture (‡πÄ‡∏ü‡∏≠‡∏£‡πå‡∏ô‡∏¥‡πÄ‡∏à‡∏≠‡∏£‡πå)</label><select name="Furniture" id="Furniture"><option value="Full">Full Furnished</option><option value="Partial">Partially Furnished</option><option value="No">No</option></select></div>

            <div class="md:col-span-2 border-b pb-2"><h2 class="text-blue-600 font-bold">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</h2></div>
            <div><label>Price (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô 4700000)</label><input type="number" name="Price" id="Price"></div>
            <div><label>FB Link (‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ Facebook)</label><input type="text" name="FBLink" id="FBLink"></div>
            <div class="md:col-span-2"><label>ImageUrls (‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤ , )</label><textarea name="ImageUrls" id="ImageUrls" rows="2"></textarea></div>

            <div class="md:col-span-2 pt-4">
                <button type="submit" id="submitBtn" class="w-full bg-[#06C755] text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:bg-green-600 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheets</button>
            </div>
        </form>
    </div>

    <script>
        let fullData = [];

        // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.onload = () => {
            google.script.run.withSuccessHandler(populateSelector).getBackendData();
        };

        function populateSelector(data) {
            fullData = data;
            const select = document.getElementById('editSelector');
            select.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç / ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" --</option>';
            data.forEach((row, index) => {
                if(row[0]) {
                    const opt = document.createElement('option');
                    opt.value = index;
                    opt.text = `‡πÅ‡∏õ‡∏•‡∏á: ${row[0]} - ${row[1]}`;
                    select.add(opt);
                }
            });
        }

        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏•‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
        function loadSelectedData() {
            const index = document.getElementById('editSelector').value;
            if (index === "") { resetForm(); return; }
            const row = fullData[index];
            
            // Mapping ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
            document.getElementById('ID').value = row[0];
            document.getElementById('Plot').value = row[1];
            document.getElementById('Type').value = row[2];
            document.getElementById('Status').value = row[3];
            document.getElementById('Badge').value = row[4];
            document.getElementById('ImageUrls').value = row[5];
            document.getElementById('Description').value = row[6];
            document.getElementById('BedRoom').value = row[7];
            document.getElementById('BathRoom').value = row[8];
            document.getElementById('PaVilion').value = row[9];
            document.getElementById('LandSqM').value = row[10];
            document.getElementById('LandSqW').value = row[11];
            document.getElementById('HouseSize').value = row[12];
            document.getElementById('PoolSize').value = row[13];
            document.getElementById('PoolDeep').value = row[14];
            document.getElementById('CarPark').value = row[15];
            document.getElementById('Electrical').value = row[16];
            document.getElementById('Furniture').value = row[17];
            document.getElementById('Price').value = row[18];
            document.getElementById('FBLink').value = row[19];
            
            document.getElementById('submitBtn').innerText = "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏õ‡∏•‡∏á " + row[0];
            document.getElementById('submitBtn').classList.replace('bg-[#06C755]', 'bg-blue-600');
        }

        function resetForm() {
            document.getElementById('propertyForm').reset();
            document.getElementById('editSelector').value = "";
            document.getElementById('submitBtn').innerText = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheets";
            document.getElementById('submitBtn').classList.replace('bg-blue-600', 'bg-[#06C755]');
        }

        function handleFormSubmit(formObject) {
            event.preventDefault();
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('submitBtn').innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";
            
            google.script.run.withSuccessHandler((msg) => {
                alert(msg);
                location.reload(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô Dropdown
            }).savePropertyData(formObject);
        }
    </script>
</body>
</html>
